require("source-map-support").install(),function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-redux")},function(e,t){e.exports=require("react-icons")},function(e,t){e.exports=require("react-icons/fa")},function(e,t){e.exports=require("react-router-dom")},function(e,t){e.exports=require("redux")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("babel-polyfill")},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports=require("redux-thunk")},function(e,t,n){n(7),e.exports=n(15)},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("babel-core/register")},function(e,t,n){"use strict";n.r(t);n(13);var r=n(0),o=n.n(r),a=n(8),c=n(1),i=n(4),u=n(5),l="ADD_TIMER",s="EDIT_COUNTER",f="REMOVE_COUNTER",p="START_COUNTING",d="STOP_COUNTING",m=function(e){return e.json()},y=function(e){return console.error(e)};function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return[j({},t)].concat(O(e));case d:return e.map((function(e){return e._id==t.idTimer?b({},e,{isActive:!1,dateStop:t.dateStop}):e}));default:return e}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return{isActive:t.isActive,limit:t.limit,dateStart:t.dateStart};default:return e}};function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:return[].concat(x(e),[{id:t._id,name:t.name,count:t.count,dateCreate:t.dateCreate,story:t.story}]);case d:return e.map((function(e){return e.id==t.id?S({},e,{count:t.count,story:g(e.story,t)}):e}));case s:return e.map((function(e){return e.id==t.id?S({},e,{name:t.name}):e}));case f:return e.filter((function(e){return e.id!=t.id}));case p:return e.map((function(e){return e.id==t.id?S({},e,{story:g(e.story=[],t)}):e}));default:return e}},A=n(9),C=n.n(A);function T(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var N=function(e){return function(t){return function(n){var r;return console.groupCollapsed("dispatching",n.type),console.log("prev state",e.getState()),console.log("action",n),r=t(n),console.log("next state",e.getState()),console.groupEnd(),r}}},k=function(e){return function(e){return function(t){return console.log("\n dispatching server action\n"),console.log(t),console.log("\n"),e(t)}}},D=function(e){return[e?k:N,C.a]},I=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return u.applyMiddleware.apply(void 0,T(D(e)))(u.createStore)(P,t)},_=Object(r.createContext)(),R=function(){var e=Object(r.useContext)(_);return o.a.createElement("span",null,Math.trunc(e/60/60),"h")},q=function(){var e=Object(r.useContext)(_);return o.a.createElement("span",null,Math.trunc(e/60)%60,"m")},M=function(){var e=Object(r.useContext)(_);return o.a.createElement("span",null,e%60,"s")},U=function(){return o.a.createElement("div",{className:"current-count"},o.a.createElement(R,null),o.a.createElement(q,null),o.a.createElement(M,null))},F=function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])};function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var J=function(){var e=B(Object(r.useState)(0),2),t=e[0],n=e[1],a=B(Object(r.useState)(0),1)[0],c=B(Object(r.useState)(!1),2),i=c[0],u=c[1];F((function(){n(t+1)}),i?a:null);return o.a.createElement("div",null,o.a.createElement(_.Provider,{value:t},o.a.createElement(U,null)),o.a.createElement("button",{onClick:function(){u(!0)}},"start"),o.a.createElement("button",{onClick:function(){u(!1)}},"stop"),o.a.createElement("button",{onClick:function(){n(0)}},"clear"))},G=function(){return o.a.createElement("div",null,"404")},z=n(2),K=n(3),L=function(){var e=Object(r.useContext)(_);return o.a.createElement("span",null,Math.trunc(e/60/60),"h")},Q=function(){var e=Object(r.useContext)(_);return o.a.createElement("span",null,Math.trunc(e/60)%60,"m")},V=function(){var e=Object(r.useContext)(_);return o.a.createElement("span",null,e%60,"s")},Y=function(){return o.a.createElement("div",{className:"left-count"},o.a.createElement(L,null),o.a.createElement(Q,null),o.a.createElement(V,null))},H={1:0,2:9e4,3:18e4,4:36e4,5:18e5,6:36e5,7:54e5,8:72e5,9:18e6,10:36e6};function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var X=function(e){var t=e.count,n=W(Object(r.useState)(0),2),a=n[0],c=n[1],i=W(Object(r.useState)(0),2),u=i[0],l=i[1],s=W(Object(r.useState)(0),2),f=s[0],p=s[1],d=W(Object(r.useState)(0),2),m=d[0],y=d[1];return Object(r.useEffect)((function(){var e;for(var n in H)t>H[n]&&(e=n);if(c(e),e<10){var r=+e+1,o=Math.trunc((t-H[e])/(H[r]-H[e])*100);l(r),p(H[r]-t),y(o)}else 0==t?(c(1),l(2),p(H[2])):(l("Max"),p(0),y(100))}),[t]),o.a.createElement("div",{className:"progress-bar-block"},o.a.createElement(_.Provider,{value:t},o.a.createElement(U,null)),o.a.createElement("div",{className:"progress-bar"},o.a.createElement("div",{className:"bar",style:{width:"".concat(m,"%")}})),o.a.createElement("div",{className:"level-panel"},o.a.createElement("span",{className:"level"},a),o.a.createElement(_.Provider,{value:f},o.a.createElement(Y,null)),o.a.createElement("span",{className:"level"},u)))};function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var $=Object(c.connect)(null,(function(e){return{onStop:function(t,n,r){e(function(e,t,n){return function(r){return fetch("/api/stop",{method:"PUT",body:JSON.stringify({id:e,count:t,dateStop:n}),headers:{"Content-Type":"application/json"},credentials:"include"}).then(m).then(r).catch(y)}}(t,n,r))},onStart:function(t,n){e(function(e,t){return function(n){return fetch("/api/start",{method:"PUT",body:JSON.stringify({id:e,dateStart:t}),headers:{"Content-Type":"application/json"},credentials:"include"}).then(m).then(n).catch(y)}}(t,n))}}}))((function(e){var t=e.id,n=e.name,a=e.count,c=e.onStop,i=e.onStart,u=Z(Object(r.useState)(a),2),l=u[0],s=u[1],f=Z(Object(r.useState)(1e3),1)[0],p=Z(Object(r.useState)(!1),2),d=p[0],m=p[1];F((function(){s(l+1)}),d?f:null);return o.a.createElement("div",{className:"container flex-container "},o.a.createElement("span",{className:"title"},n),o.a.createElement(X,{count:l}),d?o.a.createElement(z.IconContext.Provider,{value:{color:"#6F4D46"}},o.a.createElement(K.FaStop,{onClick:function(){m(!1),c(t,l,new Date)},className:"btn-timer"})):o.a.createElement(z.IconContext.Provider,{value:{color:"#6F4D46"}},o.a.createElement(K.FaPlay,{onClick:function(){m(!0),i(t,new Date)},className:"btn-timer"})))})),ee=Object(c.connect)(null,(function(e){return{onAdd:function(t){e(function(e){return function(t){return fetch("/api/add",{method:"POST",body:JSON.stringify({title:e}),headers:{"Content-Type":"application/json"}}).then(m).then(t).catch(y)}}(t)),console.log(t)}}}))((function(e){var t=e.onAdd,n=Object(r.useRef)(null);return o.a.createElement("div",{className:"add-form-container"},o.a.createElement("div",null,o.a.createElement("div",null,"Title"),o.a.createElement("input",{ref:n}),o.a.createElement(z.IconContext.Provider,{value:{color:"#6F4D46"}},o.a.createElement(K.FaPlus,{className:"btn-add-inside",onClick:function(){return t(n.current.value)}}))))}));function te(){return(te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var re=Object(c.connect)((function(e){return{counts:e}}),null)((function(e){var t=e.counts,n=ne(Object(r.useState)(!1),2),a=n[0],c=n[1];return o.a.createElement("div",{className:"container-timers"},t.map((function(e,t){return o.a.createElement($,te({key:t,id:e._id},e))})),a&&o.a.createElement("div",{style:{margin:"auto",display:"inherit"}},o.a.createElement(ee,null),o.a.createElement(z.IconContext.Provider,{value:{color:"#DF9077"}},o.a.createElement(K.FaMinusCircle,{className:"btn-add",onClick:function(){return c(!1)}})))||o.a.createElement(z.IconContext.Provider,{value:{color:"#DF9077"}},o.a.createElement(K.FaPlusCircle,{className:"btn-add",onClick:function(){return c(!0)}})))})),oe=function(){return o.a.createElement(i.Switch,null,o.a.createElement(i.Route,{exact:!0,path:"/test"},o.a.createElement(J,null)),o.a.createElement(i.Route,{exact:!0,path:"/"},o.a.createElement(re,null)),o.a.createElement(i.Route,null,o.a.createElement(G,null)))},ae=n(6);function ce(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ie(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function ue(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){ie(a,r,o,c,i,"next",e)}function i(e){ie(a,r,o,c,i,"throw",e)}c(void 0)}))}}function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fe=n(6);n(14),n(7);var pe=fe.json(),de=Object(ae.Router)(),me=function(e,t,n){e.store.dispatch(n),t.status(200).json(n)};de.post("/add",pe,(function(e,t){if(!e.body)return t.sendStatus(400);var n=e.body.title,r=new Se({name:n,count:0,dateCreate:new Date});r.save().then((function(){me(e,t,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({type:l},r._doc))})).catch((function(e){console.log("Error --\x3e ",e),t.sendStatus(500).send(e)}))})),de.put("/start",pe,function(){var e=ue(regeneratorRuntime.mark((function e(t,n){var r,o,a,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("start"),t.body){e.next=4;break}return e.abrupt("return",n.sendStatus(400));case 4:return r=t.body.id,o=t.body.dateStart,a={isActive:!0,limit:2700,dateStart:o},e.next=9,Se.findById(r);case 9:return c=e.sent,e.next=12,Se.findByIdAndUpdate({_id:r},{story:[a].concat(ce(c.story))},{new:!0});case 12:i=e.sent,n.cookie("idActiveNote",i.story[0]._id),me(t,n,{type:p,id:r,isActive:!0,limit:2700,dateStart:o}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.log("Error --\x3e ",e.t0),t.sendStatus(500).send(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,n){return e.apply(this,arguments)}}()),de.put("/stop",pe,function(){var e=ue(regeneratorRuntime.mark((function e(t,n){var r,o,a,c,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("stop"),t.body){e.next=4;break}return e.abrupt("return",n.sendStatus(400));case 4:return r=t.body.id,o=t.body.count,a=t.body.dateStop,c=t.cookies.idActiveNote,e.next=10,Se.findOne({_id:r});case 10:return i=e.sent,e.next=13,Se.findByIdAndUpdate({_id:r},{count:o,story:i.story.map((function(e){return e._id==c?(e.isActive=!1,e.dateStop=a,e):e}))},{new:!0});case 13:u=e.sent,console.log(u),me(t,n,{type:d,id:r,idTimer:c,count:o,isActive:!1,dateStop:a}),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.log("Error --\x3e ",e.t0),t.sendStatus(500).send(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}());var ye=de;function ve(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function be(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){ve(a,r,o,c,i,"next",e)}function i(e){ve(a,r,o,c,i,"throw",e)}c(void 0)}))}}n.d(t,"Timer",(function(){return Se}));var he=n(6),Oe=n(11),ge=n(12),je=he(),Ee=(he.json(),new(0,Oe.Schema)({name:String,count:Number,dateCreate:Date,story:[{isActive:Boolean,limit:Number,dateStart:Date,dateStop:Date}]},{versionKey:!1})),Se=Oe.model("Timer",Ee);Oe.connect("mongodb://localhost:27017/time-counter",{useUnifiedTopology:!0,useNewUrlParser:!0}).then((function(){je.listen(3e3,(function(){console.log("Сервер ожидает подключения - http://localhost:3000/")}))})).catch((function(e){console.log(e)}));var we=function(){var e=be(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se.find({});case 2:o=e.sent,t.store=I(!0,o),r();case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),xe=Object(u.compose)((function(e){var t=e.html,n=e.state;return'\n  <!DOCTYPE html>\n  <html>\n  <head>\n  <meta charset="utf-8">\n  <title>Universal Color Organizer</title>\n  <link rel="stylesheet" href="style.css">\n  <link href="https://fonts.googleapis.com/css?family=Quantico&display=swap" rel="stylesheet">\n  </head>\n  <body>\n  <div id="root">'.concat(t,"</div>\n  <script>\n  window.__INITIAL_STATE__ = ").concat(JSON.stringify(n),'\n  <\/script>\n  <script src="/client.js"><\/script>\n  </body>\n  </html>\n  ')}),(function(e){var t=e.url,n=e.store;return{state:n.getState(),html:Object(a.renderToString)(o.a.createElement(c.Provider,{store:n},o.a.createElement(i.StaticRouter,{location:t,context:{}},o.a.createElement(oe,null))))}}),(function(e,t){return{store:I(!1,t),url:e}})),Pe=function(){var e=be(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se.find({});case 2:return r=e.sent,e.abrupt("return",n.status(200).send(xe(t.url,r)));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();je.get("/api/users",(function(e,t){User.find({},(function(e,n){if(e)return console.log(e);t.send(n)}))})),je.use(he.static("public")).use(ge()).use((function(e,t,n){console.log("".concat(e.method," request for '").concat(e.url,"'")),n()})).use(we).use("/api",ye).use(Pe)}]);
//# sourceMappingURL=server.bundle.js.map