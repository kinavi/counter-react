require("source-map-support").install(),function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-router-dom")},function(e,t){e.exports=require("react-redux")},function(e,t){e.exports=require("react-icons/fa")},function(e,t){e.exports=require("react-icons")},function(e,t){e.exports=require("redux")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("babel-polyfill")},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports=require("redux-thunk")},function(e,t,n){n(7),e.exports=n(15)},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("babel-core/register")},function(e,t,n){"use strict";n.r(t);n(13);var r=n(0),a=n.n(r),o=n(8),c=n(2),i=n(1),u=n(5),l="ADD_TIMER",s="START_COUNTING",f="STOP_COUNTING",d=function(e){return e.json()},m=function(e){return console.error(e)};function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:return[].concat(b(e),[{_id:t._id,name:t.name,count:t.count,dateCreate:t.dateCreate}]);case f:return e.map((function(e){return e._id==t.idTime?v({},e,{count:t.count}):e}));default:return e}};function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s:return[].concat(j(e),[{_id:t.id,idTimer:t.idTimer,isActive:t.isActive,limit:t.limit,dateStart:t.dateStart}]);case f:return e.map((function(e){return e._id==t.id?E({},e,{isActive:t.isActive,dateStop:t.dateStop}):e}));default:return e}},w=n(9),x=n.n(w);function P(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var A=function(e){return function(t){return function(n){var r;return console.groupCollapsed("dispatching",n.type),console.log("prev state",e.getState()),console.log("action",n),r=t(n),console.log("next state",e.getState()),console.groupEnd(),r}}},N=function(e){return function(e){return function(t){return console.log("\n dispatching server action\n"),console.log(t),console.log("\n"),e(t)}}},T=function(e){return[e?N:A,x.a]},C=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u.applyMiddleware.apply(void 0,P(T(e)))(u.createStore)(Object(u.combineReducers)({"сounters":h,story:S}),t)},k=Object(r.createContext)(),D=n(3),_=n(4),I=function(){var e=Object(i.useHistory)();return a.a.createElement("div",{onClick:function(t){e.push("/"),t.stopPropagation()}},a.a.createElement(_.IconContext.Provider,{value:{color:"#DF9077"}},a.a.createElement(D.FaRegArrowAltCircleLeft,{className:"btn"})))},R=function(e){var t=e.onClick;return a.a.createElement(_.IconContext.Provider,{value:{color:"#6F4D46"}},a.a.createElement(D.FaPlay,{onClick:t,className:"btn-timer"}))},M=function(e){var t=e.onClick;return a.a.createElement(_.IconContext.Provider,{value:{color:"#6F4D46"}},a.a.createElement(D.FaStop,{onClick:t,className:"btn-timer"}))},q=function(){var e=Object(r.useContext)(k);return a.a.createElement("span",null,Math.trunc(e/60/60),"h")},F=function(){var e=Object(r.useContext)(k);return a.a.createElement("span",null,Math.trunc(e/60)%60,"m")},L=function(){var e=Object(r.useContext)(k);return a.a.createElement("span",null,e%60,"s")},U=function(){return a.a.createElement("div",null,a.a.createElement(q,null),a.a.createElement(F,null),a.a.createElement(L,null))},H=function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])};function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var J=function(){var e=B(Object(r.useState)(0),2),t=e[0],n=e[1],o=B(Object(r.useState)(0),1)[0],c=B(Object(r.useState)(!1),2),u=c[0],l=c[1];H((function(){n(t+1)}),u?o:null);return a.a.createElement("div",null,a.a.createElement(i.Route,{path:"/test/1"},a.a.createElement("div",null,"Hello")),a.a.createElement(k.Provider,{value:t},a.a.createElement(U,null)),a.a.createElement("button",{onClick:function(){l(!0)}},"start"),a.a.createElement("button",{onClick:function(){l(!1)}},"stop"),a.a.createElement("button",{onClick:function(){n(0)}},"clear"))};function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var K={1:0,2:9e4,3:18e4,4:36e4,5:18e5,6:36e5,7:54e5,8:72e5,9:18e6,10:36e6},Y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=this.getCurrentLevel(t),this.level<10?(this.nextLevel=this.getNextLevel(this.level),this.rest=this.getRest(t,this.nextLevel),this.percent=this.calculatePercent(t,this.level,this.nextLevel)):(this.level=10,this.nextLevel="max",this.rest=0,this.percent=100)}var t,n,r;return t=e,(n=[{key:"getCurrentLevel",value:function(e){var t=1;for(var n in K)e>=K[n]&&(t=n);return t}},{key:"getNextLevel",value:function(e){return+e+1}},{key:"getRest",value:function(e,t){return K[t]-e}},{key:"calculatePercent",value:function(e,t,n){return Math.trunc((e-K[t])/(K[n]-K[t])*100)}}])&&G(t.prototype,n),r&&G(t,r),e}();function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Q=function(e){var t=e.count,n=z(Object(r.useState)(0),2),o=n[0],c=n[1],i=z(Object(r.useState)(0),2),u=i[0],l=i[1],s=z(Object(r.useState)(0),2),f=s[0],d=s[1],m=z(Object(r.useState)(0),2),p=m[0],v=m[1];return Object(r.useEffect)((function(){var e=new Y(t);c(e.level),l(e.nextLevel),d(e.rest),v(e.percent)}),[t]),a.a.createElement("div",{className:"container-progress-bar"},a.a.createElement("div",{className:"current-count"},a.a.createElement(k.Provider,{value:t},a.a.createElement(U,null))),a.a.createElement("div",{className:"bar-bg"},a.a.createElement("div",{className:"bar",style:{width:"".concat(p,"%")}})),a.a.createElement("div",{className:"level-panel"},a.a.createElement("span",{className:"level"},o),a.a.createElement("div",{className:"left-count"},a.a.createElement(k.Provider,{value:f},a.a.createElement(U,null))),a.a.createElement("span",{className:"level"},u)))};function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var W=Object(c.connect)((function(e){return{storys:e.story}}),(function(e){return{onStop:function(t,n,r,a){e(function(e,t,n,r){return function(a){return fetch("/api/stop",{method:"PUT",body:JSON.stringify({id:e,idStory:t,count:n,dateStop:r}),headers:{"Content-Type":"application/json"},credentials:"include"}).then(d).then(a).catch(m)}}(t,n,r,a))},onPlay:function(t,n){e(function(e,t){return function(n){return fetch("/api/start",{method:"PUT",body:JSON.stringify({id:e,dateStart:t}),headers:{"Content-Type":"application/json"},credentials:"include"}).then(d).then(n).catch(m)}}(t,n))}}}))((function(e){var t=e.storys,n=e._id,o=e.name,c=e.count,u=e.onStop,l=e.onPlay,s=V(Object(r.useState)(c),2),f=s[0],d=s[1],m=V(Object(r.useState)(1e3),1)[0],p=V(Object(r.useState)(!1),2),v=p[0],y=p[1],b=Object(i.useHistory)();Object(r.useEffect)((function(){var e=g();e&&h(e.dateStart)}),[]),H((function(){d(f+1)}),v?m:null);var h=function(e){d(O(f,E(e))),y(!0)},g=function(){return t.find((function(e){return e.idTimer==n&&e.isActive}))},E=function(e){return Math.round((new Date-new Date(e))/1e3)},O=function(e,t){return+e+t};return a.a.createElement("div",{className:"timer ",onClick:function(e){b.push("/".concat(n)),e.stopPropagation()}},a.a.createElement("span",{className:"title"},o),a.a.createElement(Q,{count:f}),a.a.createElement("div",{className:"btn-start-timer"},v?a.a.createElement(M,{onClick:function(e){y(!1),u(n,g()._id,f,new Date),e.stopPropagation()}}):a.a.createElement(R,{onClick:function(e){y(!0),l(n,new Date),e.stopPropagation()}})))})),X=function(e){return a.a.createElement("div",{className:"main-container"},e.children)},Z=function(e){return a.a.createElement("div",{className:"menu"},e.children,a.a.createElement(ae,null))},$=function(e){return a.a.createElement("div",{className:"counters-container"},e.children)},ee=function(e){return a.a.createElement("div",null,e.children)},te=function(){return a.a.createElement(i.Switch,null,a.a.createElement(i.Route,{path:"/:id"},a.a.createElement(X,null,a.a.createElement(Z,null,a.a.createElement(I,null)),a.a.createElement($,null,a.a.createElement(me,null),a.a.createElement(ve,null)),a.a.createElement(ee,null))),a.a.createElement(i.Route,{path:"/"},a.a.createElement(X,null,a.a.createElement(Z,null),a.a.createElement($,null,a.a.createElement(le,null)),a.a.createElement(ee,null,a.a.createElement(ie,null)))))},ne=function(){return a.a.createElement(i.Switch,null,a.a.createElement(i.Route,{exact:!0,path:"/exper"},a.a.createElement(ae,null),a.a.createElement(J,null)),a.a.createElement(i.Route,{path:"/"},a.a.createElement(te,null)))};function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ae=function(){var e=function(e){var t=re(Object(r.useState)(e),2),n=t[0],a=t[1];Object(r.useEffect)((function(){var e=setInterval((function(){return o()}),1e3);return function(){clearInterval(e)}}));var o=function(){a(new Date)};return n}(new Date);return a.a.createElement("div",{className:"container-clock"},a.a.createElement("div",null,e.getHours()<10?"0".concat(e.getHours()):e.getHours().toLocaleString()),a.a.createElement("div",null,":"),a.a.createElement("div",null,e.getMinutes()<10?"0".concat(e.getMinutes()):e.getMinutes().toLocaleString()))},oe=Object(c.connect)(null,(function(e){return{onAdd:function(t){e(function(e){return function(t){return fetch("/api/add",{method:"POST",body:JSON.stringify({title:e}),headers:{"Content-Type":"application/json"}}).then(d).then(t).catch(m)}}(t)),console.log(t)}}}))((function(e){var t=e.onAdd,n=e.HideAddForm,o=Object(r.useRef)(null);return a.a.createElement("div",{className:"container-add-form"},a.a.createElement("div",{className:"title"},"Title"),a.a.createElement("input",{className:"field-input",ref:o}),a.a.createElement(_.IconContext.Provider,{value:{color:"#6F4D46"}},a.a.createElement(D.FaPlus,{className:"btn-add",onClick:function(){n(),t(o.current.value)}})))}));function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ie=function(){var e=ce(Object(r.useState)(!1),2),t=e[0],n=e[1],o=function(){n(!1)};return t&&a.a.createElement("div",null,a.a.createElement(oe,{HideAddForm:o}),a.a.createElement(_.IconContext.Provider,{value:{color:"#DF9077"}},a.a.createElement(D.FaMinusCircle,{className:"btn",onClick:o})))||a.a.createElement(_.IconContext.Provider,{value:{color:"#DF9077"}},a.a.createElement(D.FaPlusCircle,{className:"btn",onClick:function(){n(!0)}}))};function ue(){return(ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var le=Object(c.connect)((function(e){return{counts:e.сounters}}),null)((function(e){var t=e.counts;return a.a.createElement("div",null,t.map((function(e,t){return a.a.createElement(W,ue({key:t},e))})))}));function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var fe=function(e){var t=e.count,n=e.limit,o=se(Object(r.useState)(0),2),c=o[0],i=o[1],u=function(){return Math.trunc(t/n*100)};return Object(r.useEffect)((function(){i(u)}),[t,n]),a.a.createElement("div",{className:"bar-bg"},a.a.createElement("div",{className:"bar",style:{width:"".concat(c,"%")}}))};function de(){return(de=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var me=Object(c.connect)((function(e){return{counts:e.сounters}}),null)((function(e){var t=e.counts,n=Object(i.useParams)().id,r=t.filter((function(e){return e._id==n}));return a.a.createElement("div",null,r.map((function(e,t){return a.a.createElement(W,de({key:t},e))})))}));function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var ve=Object(c.connect)((function(e){return{storys:e.story}}),null)((function(e){var t=e.storys,n=Object(i.useParams)().id,r=t.filter((function(e){return n==e.idTimer}));return a.a.createElement("div",{className:"container-story"},r.map((function(e,t){return a.a.createElement(be,pe({key:t},e))})))}));function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var be=function(e){e._id,e.idTimer;var t=e.isActive,n=e.limit,o=e.dateStart,c=e.dateStop,i=ye(Object(r.useState)(0),2),u=i[0],l=i[1],s=function(){return Math.trunc((new Date(c)-new Date(o))/1e3)};return Object(r.useEffect)((function(){t||l(s())}),[s,o,c,t]),!t&&a.a.createElement("div",{className:"story"},a.a.createElement("div",{className:"container-bar-story"},a.a.createElement(fe,{count:u,limit:n})),a.a.createElement("div",{className:"container-info-story"},a.a.createElement(k.Provider,{value:u},a.a.createElement(F,null),a.a.createElement(L,null)),a.a.createElement("div",{className:"container-date-story"},a.a.createElement("span",null,new Date(o).getDate()),a.a.createElement("span",null,"."),a.a.createElement("span",null,new Date(o).getMonth()),a.a.createElement("span",null,"."),a.a.createElement("span",null,new Date(o).getUTCFullYear())),a.a.createElement(k.Provider,{value:n},a.a.createElement(F,null))))},he=n(6);function ge(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function Ee(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){ge(o,r,a,c,i,"next",e)}function i(e){ge(o,r,a,c,i,"throw",e)}c(void 0)}))}}var Oe=n(6);n(14),n(7);var je=Oe.json(),Se=Object(he.Router)(),we=function(e,t,n){e.store.dispatch(n),t.status(200).json(n)};Se.post("/add",je,function(){var e=Ee(regeneratorRuntime.mark((function e(t,n){var r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.body){e.next=2;break}return e.abrupt("return",n.sendStatus(400));case 2:return r=t.body.title,a=new Re({name:r,count:0,dateCreate:new Date}),e.prev=4,e.next=7,a.save();case 7:o=e.sent,we(t,n,{type:l,_id:o._id,name:o.name,count:o.count,dateCreate:o.dateCreate}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),console.log("Error --\x3e ",e.t0),n.sendStatus(500).send(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,n){return e.apply(this,arguments)}}()),Se.put("/start",je,function(){var e=Ee(regeneratorRuntime.mark((function e(t,n){var r,a,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("start"),t.body){e.next=4;break}return e.abrupt("return",n.sendStatus(400));case 4:return r=t.body.id,a=t.body.dateStart,o=new Me({idTimer:r,isActive:!0,limit:2700,dateStart:a}),e.next=9,o.save();case 9:c=e.sent,n.cookie("idActiveNote",c._id),we(t,n,{type:s,id:c._id,idTimer:c.idTimer,isActive:!0,limit:2700,dateStart:c.dateStart}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("Error --\x3e ",e.t0),t.sendStatus(500).send(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}()),Se.put("/stop",je,function(){var e=Ee(regeneratorRuntime.mark((function e(t,n){var r,a,o,c,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("stop"),t.body){e.next=4;break}return e.abrupt("return",n.sendStatus(400));case 4:return r=t.body.idStory,a=t.body.dateStop,o=t.body.id,c=t.body.count,e.next=10,Me.findByIdAndUpdate(r,{isActive:!1,dateStop:a},{new:!0});case 10:return i=e.sent,e.next=13,Re.findByIdAndUpdate(o,{count:c},{new:!0});case 13:u=e.sent,we(t,n,{type:f,id:i._id,isActive:i.isActive,dateStop:i.dateStop,idTime:u._id,count:u.count}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.log("Error --\x3e ",e.t0),t.sendStatus(500).send(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,n){return e.apply(this,arguments)}}());var xe=Se;function Pe(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function Ae(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){Pe(o,r,a,c,i,"next",e)}function i(e){Pe(o,r,a,c,i,"throw",e)}c(void 0)}))}}n.d(t,"Timer",(function(){return Re})),n.d(t,"Story",(function(){return Me}));var Ne=n(6),Te=n(11),Ce=n(12),ke=Ne(),De=(Ne.json(),Te.Schema),_e=new De({name:String,count:Number,dateCreate:Date,isHide:Boolean},{versionKey:!1}),Ie=new De({idTimer:String,isActive:Boolean,limit:Number,dateStart:Date,dateStop:Date},{versionKey:!1}),Re=Te.model("Timer",_e),Me=Te.model("Story",Ie);Te.connect("mongodb://localhost:27017/time-counter",{useUnifiedTopology:!0,useNewUrlParser:!0}).then((function(){ke.listen(3e3,(function(){console.log("Сервер ожидает подключения - http://localhost:3000/")}))})).catch((function(e){console.log(e)}));var qe=function(){var e=Ae(regeneratorRuntime.mark((function e(t,n,r){var a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re.find({});case 2:return a=e.sent,e.next=5,Me.find({});case 5:o=e.sent,t.store=C(!0,{"сounters":a,story:o}),r();case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Fe=Object(u.compose)((function(e){var t=e.html,n=e.state;return'\n  <!DOCTYPE html>\n  <html>\n  <head>\n  <meta charset="utf-8">\n  <title>Universal Color Organizer</title>\n  <link rel="stylesheet" href="style.css">\n  <link href="https://fonts.googleapis.com/css?family=Quantico&display=swap" rel="stylesheet">\n  </head>\n  <body>\n  <div id="root">'.concat(t,"</div>\n  <script>\n  window.__INITIAL_STATE__ = ").concat(JSON.stringify(n),'\n  <\/script>\n  <script src="/client.js"><\/script>\n  </body>\n  </html>\n  ')}),(function(e){var t=e.url,n=e.store;return{state:n.getState(),html:Object(o.renderToString)(a.a.createElement(c.Provider,{store:n},a.a.createElement(i.StaticRouter,{location:t,context:{}},a.a.createElement(ne,null))))}}),(function(e,t,n){return{store:C(!1,{"сounters":t,story:n}),url:e}})),Le=function(){var e=Ae(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re.find({});case 2:return r=e.sent,e.next=5,Me.find({});case 5:return a=e.sent,e.abrupt("return",n.status(200).send(Fe(t.url,r,a)));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();ke.get("/api/users",(function(e,t){User.find({},(function(e,n){if(e)return console.log(e);t.send(n)}))})),ke.use(Ne.static("public")).use(Ce()).use((function(e,t,n){console.log("".concat(e.method," request for '").concat(e.url,"'")),n()})).use(qe).use("/api",xe).use(Le)}]);
//# sourceMappingURL=server.bundle.js.map